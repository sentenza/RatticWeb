{% extends "base.html" %}
{% load url from future %}
{% load i18n %}

{% block title %}{% trans "Staff" %} - {% trans "Rattic" %}{% endblock %}

{% block content %}
<h1>{% trans "Staff Manage" %}</h1>

<div class="btn-group">
  {% if not LDAP_ENABLED %}
    <a class="btn btn-default" href="{% url "user_add" %}">{% trans "Add User" %}</a>
  {% endif %}

  {% if not USE_LDAP_GROUPS %}
    <a class="btn btn-default" href="{% url "staff.views.groupadd" %}">{% trans "Add Group" %}</a>
  {% endif %}
  <a class="btn btn-default" href="{% url "staff.views.upload_keepass" %}">{% trans "Import Keepass" %}</a>
  <a class="btn btn-default" href="{% url "cred.views.list" 'special' 'trash' %}">{% trans "View Trash" %}</a>
  <a class="btn btn-default" href="{% url "staff.views.audit" "days" 7 %}">{% trans "Audit One Week" %}</a>
</div>

<div id="user-block">
    <h2 class="page-header">{% trans "Users" %} ({{ userlist.count }})</h2>
    <table class="table table-striped table-hover table-condensed">
      <tr>
        <th>{% trans "Username" %}</th>
        <th>{% trans "email" %}</th>
        {% if not LDAP_ENABLED %}
        <th>&nbsp;</th>
        {% endif %}
      </tr>
    {% for u in userlist %}
    <tr {% if not u.is_active %}class="danger"{% endif %}>
      <td><a href="{% url "staff.views.userdetail" u.id %}">{{ u.username }}</a></td>
      <td>{{ u.email }}</td>
      {% if not LDAP_ENABLED %}
      <td>
        <div class="text-right">
          <a href="{% url "user_edit" u.id %}" title="{% trans "Edit" %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
            {% if not u.is_active %}
                <a href="{% url "staff.views.usertogglestatus" u.id %}" title="{% trans "Enable" %}"><span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span></a>
            {% else %}
                <a href="{% url "staff.views.usertogglestatus" u.id %}" title="{% trans "Disable" %}"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></a>
            {% endif %}
          <a href="{% url "staff.views.userdelete" u.id %}" title="{% trans "Delete" %}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
        </div>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
    </table>
</div>
<div id="group-block">
    <h2 class="page-header">{% trans "Access Groups" %} ({{ grouplist.count }})</h2>
    <table class="table table-striped table-hover table-condensed">
      <tr><th>{% trans "Name" %}</th>{% if not USE_LDAP_GROUPS %}<th>&nbsp;</th>{% endif %}</tr>
    {% for g in grouplist %}
    <tr>
      <td><a href="{% url "staff.views.groupdetail" g.id %}">{{ g.name }}</a></td>
      {% if not USE_LDAP_GROUPS %}
        <td>
            <div class="text-right">
                <a href="{% url "staff.views.groupedit" g.id %}" title="{% trans "Edit" %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                <a href="{% url "staff.views.groupdelete" g.id %}" title="{% trans "Delete" %}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
            </div>
        </td>
      {% endif %}
    </tr>
    {% endfor %}
    </table>
</div>
{% endblock %}

